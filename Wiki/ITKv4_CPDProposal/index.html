<!DOCTYPE html>

<html class="client-nojs" dir="ltr" lang="en">
<head>
<meta charset="utf-8"/>
<title>ITKv4 CPDProposal</title>
<script>document.documentElement.className="client-js";RLCONF={"wgBreakFrames":!1,"wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgRequestId":"02342c06c35c384b78d4e4dc","wgCSPNonce":!1,"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":!1,"wgNamespaceNumber":0,"wgPageName":"ITKv4_CPDProposal","wgTitle":"ITKv4 CPDProposal","wgCurRevisionId":25800,"wgRevisionId":25800,"wgArticleId":5910,"wgIsArticle":!0,"wgIsRedirect":!1,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgRelevantPageName":"ITKv4_CPDProposal","wgRelevantArticleId":5910,"wgIsProbablyEditable":!1,"wgRelevantPageIsProbablyEditable":!1,"wgRestrictionEdit":[],"wgRestrictionMove":[]};RLSTATE={"site.styles":"ready","noscript":"ready","user.styles":
"ready","user":"ready","user.options":"loading","skins.monobook.styles":"ready"};RLPAGEMODULES=["site","mediawiki.page.ready","mediawiki.toc","skins.monobook.scripts"];</script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.loader.implement("user.options@1hzgi",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});});</script>
<link href="/Wiki/load.php?lang=en&amp;modules=skins.monobook.styles&amp;only=styles&amp;skin=monobook" rel="stylesheet"/>
<script async="" src="/Wiki/load.php?lang=en&amp;modules=startup&amp;only=scripts&amp;raw=1&amp;skin=monobook"></script>
<meta content="" name="ResourceLoaderDynamicStyles"/>
<link href="/Wiki/load.php?lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=monobook" rel="stylesheet"/>
<meta content="MediaWiki 1.37.1" name="generator"/>
<meta content="telephone=no" name="format-detection"/>
<meta content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0" name="viewport"/>
<link href="/favicon.ico" rel="shortcut icon"/>
<link href="/Wiki/opensearch_desc.php" rel="search" title="KitwarePublic (en)" type="application/opensearchdescription+xml"/>
<link href="https://public.kitware.com/Wiki/api.php?action=rsd" rel="EditURI" type="application/rsd+xml"/>
<link href="https://creativecommons.org/licenses/by/2.5/" rel="license"/>
<link href="/Wiki/index.php?title=Special:RecentChanges&amp;feed=atom" rel="alternate" title="KitwarePublic Atom feed" type="application/atom+xml"/>
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-ITKv4_CPDProposal rootpage-ITKv4_CPDProposal skin-monobook action-view skin--responsive"><!-- start content -->
<div class="mw-body-content mw-content-ltr" dir="ltr" id="mw-content-text" lang="en"><div class="mw-parser-output"><div aria-labelledby="mw-toc-heading" class="toc" id="toc" role="navigation"><input class="toctogglecheckbox" id="toctogglecheckbox" role="button" style="display:none" type="checkbox"/><div class="toctitle" dir="ltr" lang="en"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#CPD"><span class="tocnumber">1</span> <span class="toctext">CPD</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#What_is_CPD?"><span class="tocnumber">1.1</span> <span class="toctext">What is CPD?</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Download_CPD"><span class="tocnumber">1.2</span> <span class="toctext">Download CPD</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#How_to_use_CPD_on_ITK_Code?"><span class="tocnumber">1.3</span> <span class="toctext">How to use CPD on ITK Code?</span></a>
<ul>
<li class="toclevel-3 tocsection-5"><a href="#Short_term_solution"><span class="tocnumber">1.3.1</span> <span class="toctext">Short term solution</span></a></li>
<li class="toclevel-3 tocsection-6"><a href="#Long_term_solution"><span class="tocnumber">1.3.2</span> <span class="toctext">Long term solution</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-7"><a href="#Results"><span class="tocnumber">1.4</span> <span class="toctext">Results</span></a></li>
</ul>
</li>
</ul>
</div>
<h1><span class="mw-headline" id="CPD">CPD</span></h1>
<h2><span id="What_is_CPD.3F"></span><span class="mw-headline" id="What_is_CPD?">What is CPD?</span></h2>
<ul><li>CPD aims to detect code duplication.</li>
<li>CPD is part of PMD project</li></ul>
<p><a class="external free" href="http://pmd.sourceforge.net/cpd.html" rel="nofollow">http://pmd.sourceforge.net/cpd.html</a>
</p>
<h2><span class="mw-headline" id="Download_CPD">Download CPD</span></h2>
<p><a class="external free" href="http://sourceforge.net/projects/pmd/files/" rel="nofollow">http://sourceforge.net/projects/pmd/files/</a>
</p>
<h2><span id="How_to_use_CPD_on_ITK_Code.3F"></span><span class="mw-headline" id="How_to_use_CPD_on_ITK_Code?">How to use CPD on ITK Code?</span></h2>
<ul><li>Currently, CPD only support the following extensions for c++ files ".h", ".c", ".cpp", ".cxx", ".cc", ".C".</li></ul>
<h3><span class="mw-headline" id="Short_term_solution">Short term solution</span></h3>
<ul><li>So you first need to copy all the ITK sources and change the extension of all *.txx files to .cc</li>
<li>Then first replace existing /path/to/pmd/bin/cpd.sh by the following:</li></ul>
<pre>#!/bin/sh

## This will work in the majority of shells out there...

## This will parse a directory named on the command line and produce a
## cut and paste report for c++ files in that directory (or 'c', if you
## set the environment variable LANGUAGE to 'c').

## Note that other rules are only for Java code not C source.

## If you run into java.lang.OutOfMemoryError, try setting the environment
## variable HEAPSIZE to e.g. 1024m

DIRECTORY=$1

if [ -z "$1" ]; then
				script=`basename $0`
				echo "Usage:"
				echo " $script &lt;directory&gt;"
				exit 1
fi

# OS specific support.  $var _must_ be set to either true or false.
cygwin=false;
case "`uname`" in
  CYGWIN*) cygwin=true ;;
esac

SCRIPT_DIR=`dirname $0`
CWD="$PWD"

cd "$SCRIPT_DIR/../lib"
LIB_DIR=`pwd -P`

# If cygwin, convert to Unix form before manipulating
if $cygwin ; then
  [ -n "$JAVA_HOME" ] &amp;&amp;
    JAVA_HOME=`cygpath --unix "$JAVA_HOME"`
 [ -n "$CLASSPATH" ] &amp;&amp;
    CLASSPATH=`cygpath --path --unix "$CLASSPATH"`
fi

classpath=$CLASSPATH

build_dir="$SCRIPT_DIR/../build"

if [ -d "$build_dir" ]; then
				cd "$build_dir"
				build_dir=`pwd -P`
				classpath=$classpath:$build_dir
fi

cd "$CWD"

for jarfile in `ls $LIB_DIR/*.jar`; do
				classpath=$classpath:$jarfile
done

HEAPSIZE=${HEAPSIZE:-1024m}
LANGUAGE=${LANGUAGE:-cpp}
MINIMUM_TOKENS=${MINIMUM_TOKENS:-$2}

case "$HEAPSIZE" in
[1-9]*[mgMG]) HEAPSIZE=-Xmx$HEAPSIZE ;;
'') ;;
*) echo "HEAPSIZE '$HEAPSIZE' unknown (try: 512m)"
   exit 1
esac

case "$LANGUAGE" in
c|cpp|fortran|java|jsp|php|ruby) ;;
*) echo "Language '$LANGUAGE' unknown (try: c, cpp, fortran, java, jsp, php, ruby)"
   exit 1
esac

# For Cygwin, switch paths to Windows format before running java
if $cygwin; then
  JAVA_HOME=`cygpath --windows "$JAVA_HOME"`
  classpath=`cygpath --path --windows "$classpath"`
  DIRECTORY=`cygpath --windows "$DIRECTORY"`
fi

java $HEAPSIZE -cp $classpath net.sourceforge.pmd.cpd.CPD --minimum-tokens $MINIMUM_TOKENS --files $DIRECTORY --language $LANGUAGE --format net.sourceforge.pmd.cpd.XMLRenderer
</pre>
<ul><li>Then run</li></ul>
<pre>$ cd /path/to/pmd/bin
$ ./cpd.sh /path/to/Insight/Code 500
</pre>
<h3><span class="mw-headline" id="Long_term_solution">Long term solution</span></h3>
<ul><li>Modify CPPLanguage.java in order to make CPD work with txx file.</li>
<li>Debug see <a class="external free" href="http://sourceforge.net/projects/pmd/forums/forum/188192/topic/3778230" rel="nofollow">http://sourceforge.net/projects/pmd/forums/forum/188192/topic/3778230</a></li></ul>
<h2><span class="mw-headline" id="Results">Results</span></h2>
<ul><li>minimumtokencount=500 <a href="/Wiki/File:ITKCodeToken500.xml" title="File:ITKCodeToken500.xml">File:ITKCodeToken500.xml</a></li>
<li>minimumtokencount=200 <a href="/Wiki/File:ITKCodeToken200.xml" title="File:ITKCodeToken200.xml">File:ITKCodeToken200.xml</a></li>
<li>minimumtokencount=100 <a href="/Wiki/File:ITKCodeToken100.xml" title="File:ITKCodeToken100.xml">File:ITKCodeToken100.xml</a></li></ul>
<!-- 
NewPP limit report
Cached time: 20221130172723
Cache expiry: 86400
Reduced expiry: false
Complications: []
CPU time usage: 0.010 seconds
Real time usage: 0.012 seconds
Preprocessor visited node count: 30/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 2125/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 -total
-->
<!-- Saved in parser cache with key KitwarePublicWikiDB:pcache:idhash:5910-0!canonical and timestamp 20221130172723 and revision id 25800. Serialized with JSON.
 -->
</div>
</div>

<!-- end content --></body></html>