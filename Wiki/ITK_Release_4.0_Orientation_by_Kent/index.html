
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html dir="ltr" lang="en">
<head>
<title>ITK Release 4.0 Orientation by Kent</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="MediaWiki 1.16.0" name="generator"/>
<link href="/favicon.ico" rel="shortcut icon"/>
<link href="/Wiki/opensearch_desc.php" rel="search" title="KitwarePublic (en)" type="application/opensearchdescription+xml"/>
<link href="/Wiki/index.php?title=ITK_Release_4.0_Orientation_by_Kent&amp;action=creativecommons" rel="meta" title="Creative Commons" type="application/rdf+xml"/>
<link href="http://creativecommons.org/licenses/by/2.5/" rel="copyright"/>
<link href="/Wiki/index.php?title=Special:RecentChanges&amp;feed=atom" rel="alternate" title="KitwarePublic Atom feed" type="application/atom+xml"/>
<link href="/Wiki/skins/common/shared.css?270" media="screen" rel="stylesheet"/>
<link href="/Wiki/skins/common/commonPrint.css?270" media="print" rel="stylesheet"/>
<link href="/Wiki/skins/monobook/main.css?270" media="screen" rel="stylesheet"/>
<!--[if lt IE 5.5000]><link rel="stylesheet" href="/Wiki/skins/monobook/IE50Fixes.css?270" media="screen" /><![endif]-->
<!--[if IE 5.5000]><link rel="stylesheet" href="/Wiki/skins/monobook/IE55Fixes.css?270" media="screen" /><![endif]-->
<!--[if IE 6]><link rel="stylesheet" href="/Wiki/skins/monobook/IE60Fixes.css?270" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/Wiki/skins/monobook/IE70Fixes.css?270" media="screen" /><![endif]-->
<link href="/Wiki/index.php?title=MediaWiki:Common.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000" rel="stylesheet"/>
<link href="/Wiki/index.php?title=MediaWiki:Print.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000" media="print" rel="stylesheet"/>
<link href="/Wiki/index.php?title=MediaWiki:Monobook.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000" rel="stylesheet"/>
<link href="/Wiki/index.php?title=-&amp;action=raw&amp;maxage=18000&amp;gen=css" rel="stylesheet"/>
<script>
var skin="monobook",
stylepath="/Wiki/skins",
wgUrlProtocols="http\\:\\/\\/|https\\:\\/\\/|ftp\\:\\/\\/|irc\\:\\/\\/|gopher\\:\\/\\/|telnet\\:\\/\\/|nntp\\:\\/\\/|worldwind\\:\\/\\/|mailto\\:|news\\:|svn\\:\\/\\/",
wgArticlePath="/Wiki/$1",
wgScriptPath="/Wiki",
wgScriptExtension=".php",
wgScript="/Wiki/index.php",
wgVariantArticlePath=false,
wgActionPaths={},
wgServer="http://www.itk.org",
wgCanonicalNamespace="",
wgCanonicalSpecialPageName=false,
wgNamespaceNumber=0,
wgPageName="ITK_Release_4.0_Orientation_by_Kent",
wgTitle="ITK Release 4.0 Orientation by Kent",
wgAction="view",
wgArticleId=3214,
wgIsArticle=true,
wgUserName=null,
wgUserGroups=null,
wgUserLanguage="en",
wgContentLanguage="en",
wgBreakFrames=false,
wgCurRevisionId=12818,
wgVersion="1.16.0",
wgEnableAPI=true,
wgEnableWriteAPI=true,
wgSeparatorTransformTable=["", ""],
wgDigitTransformTable=["", ""],
wgMainPageTitle="Main Page",
wgFormattedNamespaces={"-2": "Media", "-1": "Special", "0": "", "1": "Talk", "2": "User", "3": "User talk", "4": "KitwarePublic", "5": "KitwarePublic talk", "6": "File", "7": "File talk", "8": "MediaWiki", "9": "MediaWiki talk", "10": "Template", "11": "Template talk", "12": "Help", "13": "Help talk", "14": "Category", "15": "Category talk", "100": "Projects/ParaViewWeb", "101": "Projects/ParaViewWeb Talk", "102": "Projects/VTKWeb", "103": "Projects/VTKWeb Talk"},
wgNamespaceIds={"media": -2, "special": -1, "": 0, "talk": 1, "user": 2, "user_talk": 3, "kitwarepublic": 4, "kitwarepublic_talk": 5, "file": 6, "file_talk": 7, "mediawiki": 8, "mediawiki_talk": 9, "template": 10, "template_talk": 11, "help": 12, "help_talk": 13, "category": 14, "category_talk": 15, "projects/paraviewweb": 100, "projects/paraviewweb_talk": 101, "projects/vtkweb": 102, "projects/vtkweb_talk": 103, "image": 6, "image_talk": 7},
wgSiteName="KitwarePublic",
wgCategories=[],
wgRestrictionEdit=[],
wgRestrictionMove=[];
</script><script src="/Wiki/skins/common/wikibits.js?270"></script>
<script src="/Wiki/skins/common/ajax.js?270"></script>
<script src="/Wiki/index.php?title=-&amp;action=raw&amp;gen=js&amp;useskin=monobook&amp;270"></script>
</head>
<body class="mediawiki ltr ns-0 ns-subject page-ITK_Release_4_0_Orientation_by_Kent skin-monobook"><!-- start content -->
<pre>
The other solution proposed -- making Get/SetDirection do nothing in
itk::Image, but do something in itk::OrientedImage breaks things for another
class of applications -- those that primarily use direction cosines to
recover the patient orientation when they read an image.  Once images are
read and oriented to a common frame, the application is free to assume that
all images so oriented are nominally consistent in their anatomical
orientation.

Programs written to that paradigm basically ignore the direction cosines
mostly or completely, once all the noses are pointing the same way.

There's three concepts that collide when it comes to orientation. In order
to form a more perfect ITK, need to be considered.

1. Gross anatomical orientation -- you want to compare two volumes, one
acquired head first, and another feet first.  This is addressed by
* itk::SpatialOrientation (defines all 48 possible orientations)
* itk::SpatialOrientationAdapter (converts between spatial oriention codes
and direction cosines)
* Direction cosines (orientation info recovered from image files is
converted and stored therein)

2. Actual orientation ‹ the orientation info recovered can be from oblique
scans and it is stored in direction cosines.  This conflicts (somewhat) with
concept #1, in that going from the actual orientation to the gross
anatomical orientation squares up the direction cosines and loses the
rotational information.

3. General spatial transforms, addressed by itk::Transform and it¹s
children.  These are what are used by Registration and SpatialObjects to
move anatomy or geometry around.

There is a head-on collision between concept #3 and concept #1 and #2 in the
case of itk::Image and itk::OrientedImage participating in the SpatialObject
hierachy.  SpatialObjects live in a nested set of reference frames,  the
outermost of which is the traditionally (and dubiously) named ŒWorld¹
coordinate system.  Anyone who has to deal with this stuff eventually gets a
headache, because you always want to get ahold of some transform T, and have
to pace the corridor for 15 minutes to figure out which direction ŒT¹ has to
go ‹ world to local, local to world? -- and which order transforms need to
be multiplied to get the results you want.

The cream of the jest is that concept 3 defines the world coordinate system
is represented by the identity matrix, but concept 1 and 2 think the
identity matrix is one of 48 different ways to define how voxels are
organized in memory with respect to anatomy, the one labeled 'RAI.'

What needs to be worked out ‹ and believe me I have no idea right now how to
do it ‹ is to find a way to keep these concepts separated in ITK.  I don¹t
entirely follow the problems that direction cosines are causing in Spatial
Objects,  but it is obvious to me that we¹re making the direction cosines do
double duty in a way that isn¹t working.

At any rate, the state of play is this: 1) The status quo is a priori
backwards compatible, but broken 2) Both proposed solutions will break
backwards compatibility. 3) The proposed solutions are mutually
incompatible.

So perhaps it's right to table it for the moment and see if anyone comes up
with a bright idea to resolve things.

Kent Williams
</pre>
<!-- 
NewPP limit report
Preprocessor node count: 4/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->
<!-- Saved in parser cache with key KitwarePublicWikiDB:pcache:idhash:3214-0!1!0!!en!2!edit=0 and timestamp 20100922013759 -->

 <!-- end content --></body></html>
